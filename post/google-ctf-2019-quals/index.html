<!DOCTYPE html>
<html lang="en-us">

<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="generator" content="Source Themes Academic 4.3.1">

  

  
  
  
  
  
    
    
    
  
  

  <meta name="author" content="j3rrry">

  
  
  
    
  
  <meta name="description" content="Doomed to Repeat It.">

  
  <link rel="alternate" hreflang="en-us" href="/post/google-ctf-2019-quals/">

  


  

  
  
  
  <meta name="theme-color" content="#2962ff">
  

  
  
  
  
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/academicons/1.8.6/css/academicons.min.css" integrity="sha256-uFVgMKfistnJAfoCUQigIl+JfUaP47GrRKjf6CTPVmw=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.6.0/css/all.css" integrity="sha384-aOkxzJ5uQz7WBObEZcHvV5JvRW3TUc2rNPA7pe3AwnsUohiw1Vj2Rgx2KSOkF5+h" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.2.5/jquery.fancybox.min.css" integrity="sha256-ygkqlh3CYSUri3LhQxzdcm0n1EQvH2Y+U5S2idbLtxs=" crossorigin="anonymous">

    
    
    
      
    
    

    

    

  

  
  
  <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Montserrat:400,700|Roboto:400,400italic,700|Roboto+Mono">
  

  
  
  
  <link rel="stylesheet" href="/css/academic.min.5d59308488875ca6f738705133115e8c.css">

  
    
    
    
    
      
    
      
    
    
    
    <link rel="stylesheet" href="/css/academic.9d6ce9c04eee97bcc8f93581ce7495e2.css">
  

  
  
    <script>
      window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
      ga('create', 'UA-85394819-3', 'auto');
      
      ga('require', 'eventTracker');
      ga('require', 'outboundLinkTracker');
      ga('require', 'urlChangeTracker');
      ga('send', 'pageview');
    </script>
    <script async src="//www.google-analytics.com/analytics.js"></script>
    
    <script async src="https://cdnjs.cloudflare.com/ajax/libs/autotrack/2.4.1/autotrack.js" integrity="sha512-HUmooslVKj4m6OBu0OgzjXXr+QuFYy/k7eLI5jdeEy/F4RSgMn6XRWRGkFi5IFaFgy7uFTkegp3Z0XnJf3Jq+g==" crossorigin="anonymous"></script>
    
  
  

  

  <link rel="manifest" href="/site.webmanifest">
  <link rel="icon" type="image/png" href="/img/icon.png">
  <link rel="apple-touch-icon" type="image/png" href="/img/icon-192.png">

  <link rel="canonical" href="/post/google-ctf-2019-quals/">

  
  
  
  
    
    
  
  <meta property="twitter:card" content="summary">
  
  <meta property="twitter:site" content="@leunja">
  <meta property="twitter:creator" content="@leunja">
  
  <meta property="og:site_name" content="j3rrry">
  <meta property="og:url" content="/post/google-ctf-2019-quals/">
  <meta property="og:title" content="Google CTF 2019 Quals | j3rrry">
  <meta property="og:description" content="Doomed to Repeat It."><meta property="og:image" content="/img/icon-192.png">
  <meta property="og:locale" content="en-us">
  
  <meta property="article:published_time" content="2019-06-24T17:01:05&#43;09:00">
  
  <meta property="article:modified_time" content="2019-06-24T17:01:05&#43;09:00">
  

  


  





  <title>Google CTF 2019 Quals | j3rrry</title>

</head>


<body id="top" data-spy="scroll" data-target="#TableOfContents" data-offset="71" >

  <aside class="search-results" id="search">
  <div class="container">
    <section class="search-header">

      <div class="row no-gutters justify-content-between mb-3">
        <div class="col-6">
          <h1>Search</h1>
        </div>
        <div class="col-6 col-search-close">
          <a class="js-search" href="#"><i class="fas fa-times-circle text-muted" aria-hidden="true"></i></a>
        </div>
      </div>

      <div id="search-box">
        
        <input name="q" id="search-query" placeholder="Search..." autocapitalize="off"
        autocomplete="off" autocorrect="off" role="textbox" spellcheck="false" type="search">
        
      </div>

    </section>
    <section class="section-search-results">

      <div id="search-hits">
        
      </div>

    </section>
  </div>
</aside>


  
<nav class="navbar navbar-light fixed-top navbar-expand-lg py-0" id="navbar-main">
  <div class="container">

    
      <a class="navbar-brand" href="/">j3rrry</a>
      
      <button type="button" class="navbar-toggler" data-toggle="collapse"
              data-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
        <span><i class="fas fa-bars"></i></span>
      </button>
      

    
    <div class="collapse navbar-collapse" id="navbar">

      
      
      <ul class="navbar-nav mr-auto">
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#about"><span>Home</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#posts"><span>Posts</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#tags"><span>Tags</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        

        <li class="nav-item">
          <a class="nav-link " href="/malware/"><span>Malware</span></a>
        </li>

        
        

        

        
        
        

        
        
        
        
        
        

        <li class="nav-item">
          <a class="nav-link " href="/cq/"><span>CQ-RankCalc</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#contact"><span>Contact</span></a>
        </li>

        
        

      
      </ul>
      <ul class="navbar-nav ml-auto">
      

        

        
        <li class="nav-item">
          <a class="nav-link js-search" href="#"><i class="fas fa-search" aria-hidden="true"></i></a>
        </li>
        

        

        
        <li class="nav-item">
          <a class="nav-link js-dark-toggle" href="#"><i class="fas fa-moon" aria-hidden="true"></i></a>
        </li>
        

      </ul>

    </div>
  </div>
</nav>


  <article class="article" itemscope itemtype="http://schema.org/Article">

  












  

  
  
  
<div class="article-container pt-3">
  <h1 itemprop="name">Google CTF 2019 Quals</h1>

  
  <p class="page-subtitle">Doomed to Repeat It.</p>
  

  
    



<meta content="2019-06-24 17:01:05 &#43;0900 KST" itemprop="datePublished">
<meta content="2019-06-24 17:01:05 &#43;0900 KST" itemprop="dateModified">

<div class="article-metadata">

  
  

  
  <span class="article-date">
    
    
      
    
    <time>2019-06-24</time>
  </span>
  

  

  
  <span class="middot-divider"></span>
  <span class="article-reading-time">
    4 min read
  </span>
  

  
  
  <span class="middot-divider"></span>
  <a href="/post/google-ctf-2019-quals/#disqus_thread"></a>
  

  
  
  <span class="middot-divider"></span>
  <span class="article-categories">
    <i class="fas fa-folder"></i>
    <a href="/categories/ctf/">CTF</a></span>
  

  
    
<div class="share-box" aria-hidden="true">
  <ul class="share">
    <li>
      <a class="twitter"
         href="https://twitter.com/intent/tweet?text=Google%20CTF%202019%20Quals&amp;url=%2fpost%2fgoogle-ctf-2019-quals%2f"
         target="_blank" rel="noopener">
        <i class="fab fa-twitter"></i>
      </a>
    </li>
    <li>
      <a class="facebook"
         href="https://www.facebook.com/sharer.php?u=%2fpost%2fgoogle-ctf-2019-quals%2f"
         target="_blank" rel="noopener">
        <i class="fab fa-facebook-f"></i>
      </a>
    </li>
    <li>
      <a class="linkedin"
         href="https://www.linkedin.com/shareArticle?mini=true&amp;url=%2fpost%2fgoogle-ctf-2019-quals%2f&amp;title=Google%20CTF%202019%20Quals"
         target="_blank" rel="noopener">
        <i class="fab fa-linkedin-in"></i>
      </a>
    </li>
    <li>
      <a class="weibo"
         href="http://service.weibo.com/share/share.php?url=%2fpost%2fgoogle-ctf-2019-quals%2f&amp;title=Google%20CTF%202019%20Quals"
         target="_blank" rel="noopener">
        <i class="fab fa-weibo"></i>
      </a>
    </li>
    <li>
      <a class="email"
         href="mailto:?subject=Google%20CTF%202019%20Quals&amp;body=%2fpost%2fgoogle-ctf-2019-quals%2f">
        <i class="fas fa-envelope"></i>
      </a>
    </li>
  </ul>
</div>


  

</div>

    














  
</div>



  <div class="article-container">

    <div class="article-style" itemprop="articleBody">
      

<p>Google CTF 2019 Quals</p>

<h1 id="index">index</h1>

<ol>
<li>Misc<br />
1.1. <a href="#doomed-to-repeat-it">Doomed to Repeat It</a> <code>#golang</code>, <code>#brute force</code><br /></li>
</ol>

<h2 id="doomed-to-repeat-it">Doomed to Repeat It</h2>

<p><strong>본 Writeup은 <a href="https://ctftime.org/writeup/15811" target="_blank">Reptilian Shapeshifters&rsquo; Writeup</a>과 <a href="https://ctftime.org/writeup/15815" target="_blank">Sl33perSh3ll&rsquo;s Writeup</a>을 재구성한 것입니다.</strong></p>

<p>solves: 65</p>

<blockquote>
<p>Play the classic game Memory. Feel free to download and study the source code.<br />
<a href="https://doomed.web.ctfcompetition.com/" target="_blank">https://doomed.web.ctfcompetition.com/</a><br />
<a href="https://storage.googleapis.com/gctf-2019-attachments/7d6680177ddf33167700f021db01c260fac0b25cc05e28d3803a224046fee461" target="_blank">Download Attachment</a></p>
</blockquote>

<p>65명이 푼 Doomed to Repeat It 문제입니다.
&lsquo;클래식 게임인 메모리를 플레이하세요.
소스 코드를 편하게 다운로드해서 분석하세요.&rsquo;
라면서 웹 사이트 링크와 사이트의 소스 코드를 제공해줍니다.</p>

<p>웹 사이트에 접속해보면 아래와 같이 나온다.<br />
<img src="https://user-images.githubusercontent.com/19237789/60003195-266da180-96a5-11e9-9736-aae4298997d0.png" alt="site" /></p>

<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-diff" data-lang="diff">Welcome to the classic game Memory.

Rules are simple: pick an unsolved tile, then pick the matching tile. Solve all the tiles to win!

You are limited in how many guesses you can make, and in how much time per guess. Guess well!

Play
</code></pre></div>

<p><a href="https://en.wikipedia.org/wiki/Concentration_(game)" target="_blank">Memory</a>: 짝 맞추기 게임 위키<br />
<a href="https://doomed.web.ctfcompetition.com/game.html" target="_blank">Play</a>: game.html</p>




<figure>

<img src="https://i.imgur.com/2hGmv4K.gif" />



<figcaption data-pre="Figure " data-post=":" >
  <h4><a href="https://ctftime.org/writeup/15815" target="_blank">https://ctftime.org/writeup/15815</a></h4>
  
</figcaption>

</figure>

<p>Play를 누르면 game.html 링크로 들어가집니다.
이곳에서 짝 맞추기 게임을 하는데
10초 안에 카드 하나씩 선택해야만 하고
카드를 최대 60번 뒤집어 볼 수 있습니다.
짝을 맞추려면 카드를 2번 뒤집어야만 합니다.
따라서, 최대 30번의 짝을 맞춰볼 수 있습니다.</p>

<p>8 x 7 이므로 56개이고
숫자가 0부터 27까지. 총 28 쌍으로 이루어져 있습니다.</p>

<p>그런데 <strong>60번 중에 실패는 4번까지만 허용됩니다</strong>.
시작할 때 후면이 위로 오도록 뒤집어져 있는 채로 시작하기 때문에
찾고자 하는 카드가 어디에 있는지 확인하기 위해서 한 번씩은 뒤집어봐야 하지만
60번의 시도 중에 56번은 정답을 맞히는 데에 써야 합니다.</p>

<p>그래서 main.go 소스 코드를 분석해보니 카드 배열의 경우의 수가 일부 중복되어 출현한다는 것을 알아냈습니다. (난수 발생에 문제가 있음)
10만 가지의 경우 중 중복이 23,438개가 있었고 이는 확률상으로 봤을 때 4~5번에 한 번꼴로 중복된다고 볼 수 있습니다.</p>

<p>익스플로잇 코드의 간략 설명:</p>

<ol>
<li>websocket으로 4개의 카드를 확인</li>
<li>미리 준비한 23,438개의 카드 배열에서 일치하는 것이 있는지 확인</li>
<li>일치하면 56개의 카드 맞추고 Flag 출력</li>
</ol>

<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">  1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">  2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">  3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">  4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">  5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">  6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">  7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">  8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">  9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 13
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 14
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 15
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 16
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 17
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 18
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 19
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 20
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 21
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 22
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 23
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 24
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 25
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 26
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 27
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 28
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 29
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 30
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 31
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 32
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 33
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 34
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 35
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 36
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 37
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 38
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 39
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 40
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 41
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 42
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 43
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 44
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 45
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 46
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 47
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 48
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 49
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 50
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 51
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 52
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 53
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 54
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 55
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 56
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 57
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 58
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 59
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 60
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 61
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 62
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 63
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 64
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 65
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 66
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 67
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 68
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 69
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 70
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 71
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 72
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 73
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 74
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 75
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 76
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 77
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 78
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 79
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 80
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 81
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 82
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 83
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 84
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 85
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 86
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 87
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 88
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 89
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 90
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 91
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 92
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 93
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 94
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 95
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 96
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 97
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 98
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 99
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">100
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">101
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">102
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">103
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">104
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">105
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">106
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">107
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">108
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">109
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">110
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">111
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">112
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">113
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">import</span> asyncio
<span style="color:#f92672">import</span> json
<span style="color:#f92672">import</span> random
<span style="color:#f92672">import</span> sys
<span style="color:#f92672">import</span> websockets

guesses <span style="color:#f92672">=</span> dict()
matched <span style="color:#f92672">=</span> []
known <span style="color:#f92672">=</span> [<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span> <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">56</span>)]
done <span style="color:#f92672">=</span> False

async <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">guess</span>(websocket, x, y):
    <span style="color:#75715e"># msg 보내기</span>
    msg <span style="color:#f92672">=</span> dict(op<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;guess&#34;</span>, body<span style="color:#f92672">=</span>dict(x<span style="color:#f92672">=</span>x, y<span style="color:#f92672">=</span>y))
    await websocket<span style="color:#f92672">.</span>send(json<span style="color:#f92672">.</span>dumps(msg))
    <span style="color:#75715e"># parse</span>
    response_str <span style="color:#f92672">=</span> await websocket<span style="color:#f92672">.</span>recv()
    response <span style="color:#f92672">=</span> json<span style="color:#f92672">.</span>loads(response_str)
    board <span style="color:#f92672">=</span> response[<span style="color:#e6db74">&#34;board&#34;</span>]
    done <span style="color:#f92672">=</span> response[<span style="color:#e6db74">&#34;done&#34;</span>]
    index <span style="color:#f92672">=</span> y <span style="color:#f92672">*</span> <span style="color:#ae81ff">7</span> <span style="color:#f92672">+</span> x
    value <span style="color:#f92672">=</span> board[index]
    known[index] <span style="color:#f92672">=</span> value
    <span style="color:#75715e"># print info</span>
    <span style="color:#66d9ef">print</span>(f<span style="color:#e6db74">&#34;{x}, {y}: {value}&#34;</span>)
    <span style="color:#75715e"># make pedigree</span>
    <span style="color:#66d9ef">if</span> value <span style="color:#f92672">not</span> <span style="color:#f92672">in</span> guesses:
        guesses[value] <span style="color:#f92672">=</span> [index]
    <span style="color:#66d9ef">else</span>:
        guesses[value]<span style="color:#f92672">.</span>append(index)
    <span style="color:#75715e"># if Flag contain in response. than done</span>
    <span style="color:#66d9ef">if</span> <span style="color:#e6db74">&#34;Flag&#34;</span> <span style="color:#f92672">in</span> response_str:
        <span style="color:#66d9ef">print</span>(response[<span style="color:#e6db74">&#34;message&#34;</span>])
        done <span style="color:#f92672">=</span> True
    <span style="color:#66d9ef">return</span> value

async <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">solve</span>(uri):
    <span style="color:#75715e"># Returns 403 if origin header not set.</span>
    origin <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;https://doomed.web.ctfcompetition.com&#34;</span>
    async <span style="color:#66d9ef">with</span> websockets<span style="color:#f92672">.</span>client<span style="color:#f92672">.</span>connect(uri, ssl<span style="color:#f92672">=</span>True, origin<span style="color:#f92672">=</span>origin) <span style="color:#66d9ef">as</span> websocket:
        <span style="color:#75715e"># start</span>
        msg <span style="color:#f92672">=</span> dict(op<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;info&#34;</span>)
        await websocket<span style="color:#f92672">.</span>send(json<span style="color:#f92672">.</span>dumps(msg))
        response <span style="color:#f92672">=</span> await websocket<span style="color:#f92672">.</span>recv()
        <span style="color:#66d9ef">print</span>(f<span style="color:#e6db74">&#39;{response}&#39;</span>)
        <span style="color:#75715e"># make up dictionary of cases</span>
        dupes <span style="color:#f92672">=</span> dict()
        <span style="color:#66d9ef">with</span> open(<span style="color:#e6db74">&#34;dupes.txt&#34;</span>) <span style="color:#66d9ef">as</span> f:
            <span style="color:#66d9ef">for</span> line <span style="color:#f92672">in</span> f:
                dupe <span style="color:#f92672">=</span> json<span style="color:#f92672">.</span>loads(line)
                key <span style="color:#f92672">=</span> f<span style="color:#e6db74">&#34;{dupe[0]}, {dupe[1]}, {dupe[2]}, {dupe[3]}&#34;</span>
                dupes[key] <span style="color:#f92672">=</span> dupe
        <span style="color:#75715e"># Flip the first four cards.</span>
        first <span style="color:#f92672">=</span> await guess(websocket, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>)
        second <span style="color:#f92672">=</span> await guess(websocket, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>)
        third <span style="color:#f92672">=</span> await guess(websocket, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">0</span>)
        fourth <span style="color:#f92672">=</span> await guess(websocket, <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">0</span>)
        key <span style="color:#f92672">=</span> f<span style="color:#e6db74">&#34;{first}, {second}, {third}, {fourth}&#34;</span>
        <span style="color:#66d9ef">if</span> key <span style="color:#f92672">in</span> dupes:
            <span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#34;FOUND DUPE!&#34;</span>)
            <span style="color:#66d9ef">for</span> index, value <span style="color:#f92672">in</span> enumerate(dupes[key][<span style="color:#ae81ff">4</span>:]):
                <span style="color:#75715e"># make pedigree</span>
                <span style="color:#66d9ef">if</span> value <span style="color:#f92672">not</span> <span style="color:#f92672">in</span> guesses:
                    guesses[value] <span style="color:#f92672">=</span> [index <span style="color:#f92672">+</span> <span style="color:#ae81ff">4</span>]
                <span style="color:#66d9ef">else</span>:
                    guesses[value]<span style="color:#f92672">.</span>append(index <span style="color:#f92672">+</span> <span style="color:#ae81ff">4</span>)
        <span style="color:#66d9ef">else</span>:
            <span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#34;No match. Game over.&#34;</span>)
            <span style="color:#66d9ef">return</span>

        <span style="color:#66d9ef">while</span>(<span style="color:#f92672">not</span> done):
            <span style="color:#66d9ef">for</span> value <span style="color:#f92672">in</span> guesses<span style="color:#f92672">.</span>keys():
                <span style="color:#66d9ef">if</span> len(guesses[value]) <span style="color:#f92672">==</span> <span style="color:#ae81ff">2</span> <span style="color:#f92672">and</span> value <span style="color:#f92672">not</span> <span style="color:#f92672">in</span> matched:
                    first_index <span style="color:#f92672">=</span> guesses[value][<span style="color:#ae81ff">0</span>]
                    first_x <span style="color:#f92672">=</span> first_index <span style="color:#f92672">%</span> <span style="color:#ae81ff">7</span>
                    first_y <span style="color:#f92672">=</span> first_index <span style="color:#f92672">//</span> <span style="color:#ae81ff">7</span>
                    first <span style="color:#f92672">=</span> await guess(websocket, first_x, first_y)
                    second_index <span style="color:#f92672">=</span> guesses[value][<span style="color:#ae81ff">1</span>]
                    second_x <span style="color:#f92672">=</span> second_index <span style="color:#f92672">%</span> <span style="color:#ae81ff">7</span>
                    second_y <span style="color:#f92672">=</span> second_index <span style="color:#f92672">//</span> <span style="color:#ae81ff">7</span>
                    second <span style="color:#f92672">=</span> await guess(websocket, second_x, second_y)
                    <span style="color:#66d9ef">if</span> first <span style="color:#f92672">==</span> second:
                        matched<span style="color:#f92672">.</span>append(value)
                        <span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#34;MATCHED: &#34;</span>, matched)
                    <span style="color:#66d9ef">else</span>:
                        <span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#34;MISS!!&#34;</span> , first, second)
                        <span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#34;Dupe doesn&#39;t match. Game over.&#34;</span>)
                        <span style="color:#66d9ef">return</span>
            not_found <span style="color:#f92672">=</span> [i <span style="color:#66d9ef">for</span> i, val <span style="color:#f92672">in</span> enumerate(known) <span style="color:#66d9ef">if</span> val <span style="color:#f92672">==</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>]
            <span style="color:#66d9ef">if</span> not_found:
                next_guess <span style="color:#f92672">=</span> random<span style="color:#f92672">.</span>choice(not_found)
            <span style="color:#66d9ef">else</span>:
                <span style="color:#66d9ef">return</span>
            x <span style="color:#f92672">=</span> next_guess <span style="color:#f92672">%</span> <span style="color:#ae81ff">7</span>
            y <span style="color:#f92672">=</span> next_guess <span style="color:#f92672">//</span> <span style="color:#ae81ff">7</span>
            first <span style="color:#f92672">=</span> await guess(websocket, x, y)
            <span style="color:#66d9ef">if</span> len(guesses[first]) <span style="color:#f92672">==</span> <span style="color:#ae81ff">2</span>:
                next_guess <span style="color:#f92672">=</span> guesses[first][<span style="color:#ae81ff">0</span>]
                matched<span style="color:#f92672">.</span>append(first)
            <span style="color:#66d9ef">else</span>:
                not_found <span style="color:#f92672">=</span> [i <span style="color:#66d9ef">for</span> i, val <span style="color:#f92672">in</span> enumerate(known) <span style="color:#66d9ef">if</span> val <span style="color:#f92672">==</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span> <span style="color:#f92672">and</span> i <span style="color:#f92672">!=</span> next_guess]
                next_guess <span style="color:#f92672">=</span> known<span style="color:#f92672">.</span>index(<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>)
                next_guess <span style="color:#f92672">=</span> random<span style="color:#f92672">.</span>choice(not_found)
            x <span style="color:#f92672">=</span> next_guess <span style="color:#f92672">%</span> <span style="color:#ae81ff">7</span>
            y <span style="color:#f92672">=</span> next_guess <span style="color:#f92672">//</span> <span style="color:#ae81ff">7</span>
            second <span style="color:#f92672">=</span> await guess(websocket, x, y)
            <span style="color:#66d9ef">if</span> first <span style="color:#f92672">not</span> <span style="color:#f92672">in</span> matched:
                <span style="color:#66d9ef">if</span> first <span style="color:#f92672">==</span> second:
                    matched<span style="color:#f92672">.</span>append(first)
            <span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#34;MATCHED: &#34;</span>, matched)

uri <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;wss://doomed.web.ctfcompetition.com/ws&#34;</span>
asyncio<span style="color:#f92672">.</span>get_event_loop()<span style="color:#f92672">.</span>run_until_complete(solve(uri))</code></pre></td></tr></table>
</div>
</div>

<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">33
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">34
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">35
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">36
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">37
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">38
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">39
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">40
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">41
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">42
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">43
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">44
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">45
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">46
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">47
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">48
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">49
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">50
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">51
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">52
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">53
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">54
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">55
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">56
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">57
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">58
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">59
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">60
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">61
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">62
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#75715e">// We vigorously defend against CSRF/XSRF with strict origin checks.
</span><span style="color:#75715e">// Note that without this, we would have severe vulnerabilities, because
</span><span style="color:#75715e">// browsers don&#39;t enforce the same origin policy on websockets.
</span><span style="color:#75715e">// Security is our #1 priority.
</span><span style="color:#75715e"></span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">checkOrigin</span>(<span style="color:#a6e22e">r</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">http</span>.<span style="color:#a6e22e">Request</span>) <span style="color:#66d9ef">bool</span> {
    <span style="color:#a6e22e">o</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">r</span>.<span style="color:#a6e22e">Header</span>.<span style="color:#a6e22e">Get</span>(<span style="color:#e6db74">&#34;Origin&#34;</span>)
    <span style="color:#a6e22e">p</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">r</span>.<span style="color:#a6e22e">Header</span>.<span style="color:#a6e22e">Get</span>(<span style="color:#e6db74">&#34;X-Forwarded-Proto&#34;</span>)
    <span style="color:#a6e22e">h</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">r</span>.<span style="color:#a6e22e">Host</span>
    <span style="color:#66d9ef">if</span> <span style="color:#a6e22e">o</span> <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;&#34;</span> <span style="color:#f92672">||</span> <span style="color:#a6e22e">h</span> <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;&#34;</span> {
        <span style="color:#a6e22e">log</span>.<span style="color:#a6e22e">Print</span>(<span style="color:#e6db74">&#34;Websocket missing origin and/or host&#34;</span>)
        <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">false</span>
    }
    <span style="color:#a6e22e">ou</span>, <span style="color:#a6e22e">err</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">url</span>.<span style="color:#a6e22e">Parse</span>(<span style="color:#a6e22e">o</span>)
    <span style="color:#66d9ef">if</span> <span style="color:#a6e22e">err</span> <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nil</span> {
        <span style="color:#a6e22e">log</span>.<span style="color:#a6e22e">Printf</span>(<span style="color:#e6db74">&#34;Couldn&#39;t parse url: %v&#34;</span>, <span style="color:#a6e22e">err</span>)
        <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">false</span>
    }
    <span style="color:#66d9ef">if</span> <span style="color:#a6e22e">p</span> <span style="color:#f92672">!=</span> <span style="color:#e6db74">&#34;&#34;</span> <span style="color:#f92672">&amp;&amp;</span> <span style="color:#a6e22e">ou</span>.<span style="color:#a6e22e">Scheme</span> <span style="color:#f92672">!=</span> <span style="color:#e6db74">&#34;https&#34;</span> {
        <span style="color:#a6e22e">log</span>.<span style="color:#a6e22e">Print</span>(<span style="color:#e6db74">&#34;Https websocket missing https origin&#34;</span>)
        <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">false</span>
    }
    <span style="color:#66d9ef">if</span> <span style="color:#a6e22e">ou</span>.<span style="color:#a6e22e">Host</span> <span style="color:#f92672">!=</span> <span style="color:#a6e22e">h</span> {
        <span style="color:#a6e22e">log</span>.<span style="color:#a6e22e">Print</span>(<span style="color:#e6db74">&#34;Origin doesn&#39;t match host&#34;</span>)
        <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">false</span>
    }
    <span style="color:#75715e">// TODO: Origin is a 3 tuple (scheme, host, port). Figure out how to check the
</span><span style="color:#75715e"></span>    <span style="color:#75715e">// port.
</span><span style="color:#75715e"></span>    <span style="color:#75715e">// TODO: We should enforce https origin on https ws even on non-App Engine.
</span><span style="color:#75715e"></span>    <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">true</span>
}</code></pre></td></tr></table>
</div>
</div>

<p>main.go 소스 코드를 확인해보면 CSRF나 XSRF를 방지하고자 <kbd>Origin</kbd>을 확인하고 있다고 한다.
그래서 websocket 보낼 때 Origin을 포함하지 않으면 403 Forbidden 이 뜬다.</p>

<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">31
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">32
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">33
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#75715e">// OsRand gets some randomness from the OS.
</span><span style="color:#75715e"></span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">OsRand</span>() (<span style="color:#66d9ef">uint64</span>, <span style="color:#66d9ef">error</span>) {
    <span style="color:#75715e">// 64 ought to be enough for anybody
</span><span style="color:#75715e"></span>    <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">res</span> <span style="color:#66d9ef">uint64</span>
    <span style="color:#66d9ef">if</span> <span style="color:#a6e22e">err</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">binary</span>.<span style="color:#a6e22e">Read</span>(<span style="color:#a6e22e">rand</span>.<span style="color:#a6e22e">Reader</span>, <span style="color:#a6e22e">binary</span>.<span style="color:#a6e22e">LittleEndian</span>, <span style="color:#f92672">&amp;</span><span style="color:#a6e22e">res</span>); <span style="color:#a6e22e">err</span> <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nil</span> {
        <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0</span>, <span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Errorf</span>(<span style="color:#e6db74">&#34;couldn&#39;t read random uint64: %v&#34;</span>, <span style="color:#a6e22e">err</span>)
    }
    <span style="color:#75715e">// Mix in some of our own pre-generated randomness in case the OS runs low.
</span><span style="color:#75715e"></span>    <span style="color:#75715e">// See Mining Your Ps and Qs for details.
</span><span style="color:#75715e"></span>    <span style="color:#a6e22e">res</span> <span style="color:#f92672">*=</span> <span style="color:#ae81ff">14496946463017271296</span>
    <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">res</span>, <span style="color:#66d9ef">nil</span>
}</code></pre></td></tr></table>
</div>
</div>

<p>위 코드는 random/random.go 소스 코드이며 난수 발생기를 확인할 수 있습니다.</p>

<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">&gt;&gt;&gt;</span> hex(<span style="color:#ae81ff">14496946463017271296</span>)
<span style="color:#e6db74">&#39;0xc92f800000000000L&#39;</span>
<span style="color:#f92672">&gt;&gt;&gt;</span> 
<span style="color:#f92672">&gt;&gt;&gt;</span> res <span style="color:#f92672">=</span> <span style="color:#ae81ff">8979835648265197673</span>
<span style="color:#f92672">&gt;&gt;&gt;</span> res <span style="color:#f92672">*=</span> <span style="color:#ae81ff">140737488355328</span>
<span style="color:#f92672">&gt;&gt;&gt;</span> res <span style="color:#f92672">=</span> ctypes<span style="color:#f92672">.</span>c_uint64(res)<span style="color:#f92672">.</span>value
<span style="color:#f92672">&gt;&gt;&gt;</span> bin(<span style="color:#ae81ff">140737488355328</span>)
<span style="color:#e6db74">&#39;0b100000000000000000000000000000000000000000000000&#39;</span>
<span style="color:#f92672">&gt;&gt;&gt;</span> <span style="color:#ae81ff">140737488355328</span> <span style="color:#f92672">==</span> <span style="color:#ae81ff">2</span> <span style="color:#f92672">**</span> <span style="color:#ae81ff">47</span>
True
<span style="color:#f92672">&gt;&gt;&gt;</span> bin(res)
<span style="color:#e6db74">&#39;0b100110000110100100000000000000000000000000000000000000000000000&#39;</span>
<span style="color:#f92672">&gt;&gt;&gt;</span> <span style="color:#ae81ff">2</span> <span style="color:#f92672">**</span> (<span style="color:#ae81ff">64</span><span style="color:#f92672">-</span><span style="color:#ae81ff">47</span>)
<span style="color:#ae81ff">131072</span></code></pre></div>

<p>res에 해당 숫자를 곱하면 2의 47승 아래가 전부 0으로 초기화 된다.
OsRand()는 uint64 자료형을 쓰지만 발생하는 난수의 경우의 수는 131,072(2**17)가지 밖에 안된다.
따라서, 13만 가지의 카드 배열을 레인보우 테이블처럼 만들어 놓고 풀면 된다.</p>

    </div>

    

<div class="article-tags">
  
  <a class="badge badge-light" href="/tags/ctf/">CTF</a>
  
  <a class="badge badge-light" href="/tags/google/">Google</a>
  
  <a class="badge badge-light" href="/tags/2019/">2019</a>
  
  <a class="badge badge-light" href="/tags/golang/">golang</a>
  
</div>



    
      








  





  
  
  
    
  
  
  <div class="media author-card" itemscope itemtype="http://schema.org/Person">
    
      
      <img class="portrait mr-3" src="/authors/admin/avatar_hu411e86c0f781efe1eb89419db5a5ee89_120575_250x250_fill_q90_lanczos_center.jpg" itemprop="image" alt="Avatar">
    

    <div class="media-body">
      <h5 class="card-title" itemprop="name"><a href="/">j3rrry</a></h5>
      <h6 class="card-subtitle">정보보호 컨설턴트</h6>
      <p class="card-text" itemprop="description">4년제 졸업했으며 취업연계 교육을 받았으며 CTF 참가하는 것을 좋아합니다.</p>
      <ul class="network-icon" aria-hidden="true">
        
          
          
          
            
          
          
          
          
          
            
          
          <li>
            <a itemprop="sameAs" href="/#contact" >
              <i class="fas fa-envelope"></i>
            </a>
          </li>
        
          
          
          
            
          
          
          
          
          
            
          
          <li>
            <a itemprop="sameAs" href="https://twitter.com/leunja" target="_blank" rel="noopener">
              <i class="fab fa-twitter"></i>
            </a>
          </li>
        
          
          
          
            
          
          
          
          
          
            
          
          <li>
            <a itemprop="sameAs" href="https://fb.com/n3cin1" target="_blank" rel="noopener">
              <i class="fab fa-facebook"></i>
            </a>
          </li>
        
          
          
          
            
          
          
          
          
          
            
          
          <li>
            <a itemprop="sameAs" href="https://github.com/j3rrry" target="_blank" rel="noopener">
              <i class="fab fa-github"></i>
            </a>
          </li>
        
      </ul>
    </div>
  </div>



      
      
      <div class="article-widget">
        <div class="hr-light"></div>
        <h3>Related</h3>
        <ul>
          
          <li><a href="/post/hsctf-6-writeup/">HSCTF 6 Writeup</a></li>
          
          <li><a href="/post/facebook-ctf-2019-pwnable-overfloat-writeup/">Facebook CTF 2019 Pwnable Overfloat Writeup</a></li>
          
          <li><a href="/post/easy-rev/">Easy Rev</a></li>
          
          <li><a href="/post/trust-ctf-2019/">TRUST CTF 2019</a></li>
          
          <li><a href="/post/goisforlovers/">(Hu)go Template Primer</a></li>
          
        </ul>
      </div>
      
    

    

    
<section id="comments">
  <div id="disqus_thread"></div>
<script type="application/javascript">
    var disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "j3rrry" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</section>



  </div>
</article>

      

    
    

    
    
    
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.4/imagesloaded.pkgd.min.js" integrity="sha256-lqvxZrPLtfffUl2G/e7szqSvPBILGbwmsGE1MKlOi0Q=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.isotope/3.0.6/isotope.pkgd.min.js" integrity="sha256-CBrpuqrMhXwcLLUd5tvQ4euBHCdh7wGlDfNz8vbu/iI=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.2.5/jquery.fancybox.min.js" integrity="sha256-X5PoE3KU5l+JcX+w09p/wHl9AzK333C4hJ2I9S5mD4M=" crossorigin="anonymous"></script>

      

      

      
      
    

    
    

    
    
    
    <script id="dsq-count-scr" src="//j3rrry.disqus.com/count.js" async></script>
    

    
    

    
    
    <script>
      const search_index_filename = "/index.json";
      const i18n = {
        'placeholder': "Search...",
        'results': "results found",
        'no_results': "No results found"
      };
      const content_type = {
        'post': "Posts",
        'project': "Projects",
        'publication' : "Publications",
        'talk' : "Talks"
        };
    </script>
    

    
    

    
    
    <script id="search-hit-fuse-template" type="text/x-template">
      <div class="search-hit" id="summary-{{key}}">
      <div class="search-hit-content">
        <div class="search-hit-name">
          <a href="{{relpermalink}}">{{title}}</a>
          <div class="article-metadata search-hit-type">{{type}}</div>
          <p class="search-hit-description">{{snippet}}</p>
        </div>
      </div>
      </div>
    </script>
    

    
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/3.2.1/fuse.min.js" integrity="sha256-VzgmKYmhsGNNN4Ph1kMW+BjoYJM2jV5i4IlFoeZA9XI=" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script>
    

    
    

    
    
    
    
    
    
    
    
    
      
    
    
      
    
    
    
    <script src="/js/academic.min.55cec13bc0aa6adeb045a602375e60b9.js"></script>

    






  
  <div class="container">
    <footer class="site-footer">
  

  <p class="powered-by">
    &copy; 2020 j3rrry &middot; 

    Powered by the
    <a href="https://sourcethemes.com/academic/" target="_blank" rel="noopener">Academic theme</a> for
    <a href="https://gohugo.io" target="_blank" rel="noopener">Hugo</a>.

    
    <span class="float-right" aria-hidden="true">
      <a href="#" id="back_to_top">
        <span class="button_icon">
          <i class="fas fa-chevron-up fa-2x"></i>
        </span>
      </a>
    </span>
    
  </p>
</footer>

  </div>
  

  
<div id="modal" class="modal fade" role="dialog">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Cite</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <pre><code class="tex hljs"></code></pre>
      </div>
      <div class="modal-footer">
        <a class="btn btn-outline-primary my-1 js-copy-cite" href="#" target="_blank">
          <i class="fas fa-copy"></i> Copy
        </a>
        <a class="btn btn-outline-primary my-1 js-download-cite" href="#" target="_blank">
          <i class="fas fa-download"></i> Download
        </a>
        <div id="modal-error"></div>
      </div>
    </div>
  </div>
</div>

</body>
</html>
